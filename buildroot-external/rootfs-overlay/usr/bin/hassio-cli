#!/bin/sh

# Load configs
CONFIG_FILE=/mnt/data/hassio.json

CLI="$(jq --raw-output '.cli' ${CONFIG_FILE})"
DOCKER_ARGS="$(jq --raw-output '.cli_args // empty' ${CONFIG_FILE})"
CLI_DATA=/mnt/data/cli

mkdir -p ${CLI_DATA}

# Run CLI
docker run \
    --rm -ti --init \
    -v ${CLI_DATA}:/data \
    $DOCKER_ARGS \
    ${CLI}

# Jump to root shell
if [ $? -eq 10 ]; then
    /bin/ash
fi

exit
